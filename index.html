<html>
<head>
<title>search-auctions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="shortcut icon" href="favicon.ico" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="css/bootstrap.min.css" rel="stylesheet">
<script type="text/javascript">
    function search(){
        var q = document.getElementById("query").value;
        q = q.replace(" ", "+");

        // allegro is always checked
        window.location.href = "http://allegro.pl/listing/listing.php?string=" + q + "&search_scope";
        openInNewTab("tablica", "http://tablica.pl/krakow/?search[dist]=10&q=" + q);
        openInNewTab("swistak", "http://www.swistak.pl/szukaj/"  + q);
        openInNewTab("gumtree", "http://www.gumtree.pl/fp-" + q + "/krakow/l3200208?isSearchForm=true");
    }
    function openInNewTab(id, url){
      if (document.getElementById(id).checked) {
        window.open(url, "_blank");
        enableSite(id);
      } else {
        disableSite(id);
      }
	}
  function isSiteDisabled(id) {
    if (typeof localStorage.disabled_sites != "undefined")
      return localStorage.disabled_sites.indexOf(id) != -1;
    return false;
  }
  function isSiteEnabled(id) {
    return !isSiteDisabled(id);
  }
  function disableSite(id) {
    if (typeof localStorage.disabled_sites == "undefined") {
      localStorage.disabled_sites = id;
    } else if (!isSiteDisabled(id)) {
      localStorage.disabled_sites = localStorage.disabled_sites + id;
    }
  }
  function enableSite(id) {
    if (typeof localStorage.disabled_sites != "undefined" && isSiteDisabled(id)) {
      localStorage.disabled_sites = localStorage.disabled_sites.replace(id, ""); 
    }
  }
</script>

</head>
<body>

<div class="container">

    <div class="page-header">
        <h1>Szukaj <small>na kilku serwisach aukcyjnych równocześnie</small></h1>
    </div>

    <form action="#" onsubmit="return false;">
    <div class="input-group input-group-lg">
        
      <input type="text" class="form-control" placeholder="czego dusza pragnie?" id="query"/>
      <span class="input-group-btn">
        <button id="submit" class="btn btn-default" onclick="search()">
            <span class="glyphicon glyphicon-search"></span>
        </button>
      </span>
  
    </div>

<!-- spacer: https://github.com/twbs/bootstrap/issues/4286 -->
<div style="height: 20px; width: 100%; font-size: 0; margin: 0; padding: 0; border: 0; display: block;"></div>

<div class="panel-group" id="accordion">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#advancedOptions">
          więcej opcji
        </a>
      </h4>
    </div>
    <div id="advancedOptions" class="panel-collapse collapse">
      <div class="panel-body">
        <div class="form-group">
          <div class="col-sm-10">
            <div class="checkbox">
              <label>
                <input type="checkbox" id="allegro" checked disabled>Allegro</input>
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input type="checkbox" id="swistak" checked>Świstak</input>
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input type="checkbox" id="gumtree" checked>Gumtree</input>
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input type="checkbox" id="tablica" checked> Tablica</input>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

    </form>

</div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <script type="text/javascript">
      // initial selection
      $("#swistak").attr("checked", isSiteEnabled("swistak"));
      $("#gumtree").attr("checked", isSiteEnabled("gumtree"));
      $("#tablica").attr("checked", isSiteEnabled("tablica"));
    </script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
</body>
</html>